{
  "name": "localrag",
  "displayName": "LocalRAG - Enhanced Local RAG for VS Code",
  "description": "Retrieval-Augmented Generation extension for VSCode with local sentence transformers and semantic chunking",
  "version": "0.2.8",
  "publisher": "borgius",
  "icon": "assets/icon.png",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/borgius/localrag"
  },
  "engines": {
    "vscode": "^1.105.0"
  },
  "categories": [
    "Machine Learning",
    "Extension Packs",
    "AI",
    "Chat",
    "Other"
  ],
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./out/src/extension.js",
  "contributes": {
    "configuration": {
      "title": "LocalRAG",
      "properties": {
        "localrag.localModelPath": {
          "type": "string",
          "default": "",
          "markdownDescription": "Absolute path to a folder containing a locally downloaded Transformers.js-compatible embedding model. Models in this folder appear in the tree view and can be selected directly.",
          "order": 2
        },
        "localrag.topK": {
          "type": "number",
          "default": 5,
          "description": "Number of top results to return from RAG queries",
          "minimum": 1,
          "maximum": 20,
          "order": 3
        },
        "localrag.chunkSize": {
          "type": "number",
          "default": 512,
          "description": "Maximum size of text chunks for embedding (in characters)",
          "minimum": 100,
          "maximum": 2000,
          "order": 4
        },
        "localrag.chunkOverlap": {
          "type": "number",
          "default": 50,
          "description": "Overlap between chunks (in characters)",
          "minimum": 0,
          "maximum": 500,
          "order": 5
        },
        "localrag.logLevel": {
          "type": "string",
          "default": "info",
          "description": "Logging verbosity level for the LocalRAG output channel",
          "enum": [
            "debug",
            "info",
            "warn",
            "error"
          ],
          "enumDescriptions": [
            "Debug: Verbose logging for troubleshooting (most detailed)",
            "Info: Standard informational messages (recommended)",
            "Warn: Only warnings and errors",
            "Error: Only error messages (least verbose)"
          ],
          "order": 6
        },
        "localrag.retrievalStrategy": {
          "type": "string",
          "default": "hybrid",
          "markdownDescription": "**Retrieval strategy** for RAG queries (applies to both simple and agentic modes):\n\n- **hybrid** (recommended): 70% semantic + 30% keyword\n- **vector**: Pure semantic similarity\n- **ensemble**: Advanced RRF fusion of vector + BM25 (slower, more accurate)\n- **bm25**: Pure keyword search with BM25 (no embeddings, fast exact matching)\n\nüí° _Can be overridden per query via LM tool parameter_",
          "enum": [
            "vector",
            "hybrid",
            "ensemble",
            "bm25"
          ],
          "enumDescriptions": [
            "Pure semantic search using embeddings only",
            "Hybrid: Combines semantic + keyword matching (recommended)",
            "Ensemble: Uses Reciprocal Rank Fusion with BM25 (most accurate, higher memory)",
            "BM25: Pure keyword search (Okapi BM25 algorithm, no embeddings needed)"
          ],
          "order": 9
        },
        "localrag.useAgenticMode": {
          "type": "boolean",
          "default": true,
          "markdownDescription": "**Enable Agentic RAG:** Multi-step retrieval with query planning, iterative refinement, and result evaluation. When disabled, uses simple single-shot retrieval.\n\nüìö [Learn more about Agentic RAG](https://github.com/borgius/localrag#agentic-rag)",
          "order": 10
        },
        "localrag.agenticMaxIterations": {
          "type": "number",
          "default": 3,
          "markdownDescription": "Maximum retrieval iterations in agentic mode. Higher = more thorough but slower.\n\n‚ö†Ô∏è _Only applies when Agentic Mode is enabled_",
          "minimum": 1,
          "maximum": 10,
          "order": 11
        },
        "localrag.agenticConfidenceThreshold": {
          "type": "number",
          "default": 0.7,
          "markdownDescription": "Confidence threshold (0-1) to stop retrieval. Lower = more iterations, higher = stops earlier.\n\n‚ö†Ô∏è _Only applies when Agentic Mode is enabled_",
          "minimum": 0,
          "maximum": 1,
          "order": 12
        },
        "localrag.agenticIterativeRefinement": {
          "type": "boolean",
          "default": true,
          "markdownDescription": "Generate follow-up queries to fill information gaps detected during retrieval.\n\n‚ö†Ô∏è _Only applies when Agentic Mode is enabled_",
          "order": 13
        },
        "localrag.agenticUseLLM": {
          "type": "boolean",
          "default": false,
          "markdownDescription": "**Use LLM (Copilot) for intelligent planning:** Uses Copilot for query decomposition and result evaluation instead of rule-based heuristics.\n\n**Requirements:**\n- ‚úÖ GitHub Copilot subscription\n- ‚úÖ GitHub Copilot extension\n\n**Trade-offs:**\n- ‚úÖ Much more intelligent\n- ‚úÖ Context-aware planning\n- ‚ö†Ô∏è 2-3x slower\n- ‚ö†Ô∏è Uses Copilot API quota\n\n‚ö†Ô∏è _Only applies when Agentic Mode is enabled_",
          "order": 14
        },
        "localrag.agenticLLMModel": {
          "type": "string",
          "default": "gpt-4o",
          "markdownDescription": "**LLM model to use** for query planning and evaluation:\n\n- **gpt-4o** (default): Most intelligent, best reasoning\n- **gpt-4o-mini**: Faster, cheaper, still very capable\n- **gpt-3.5-turbo**: Fastest, most economical\n\n**Performance:**\n- gpt-4o: Best quality, slower, more tokens\n- gpt-4o-mini: Good balance\n- gpt-3.5-turbo: Fast, lower quality\n\n‚ö†Ô∏è _Only applies when LLM Mode is enabled_",
          "enum": [
            "gpt-4o",
            "gpt-4o-mini",
            "gpt-3.5-turbo"
          ],
          "enumDescriptions": [
            "GPT-4o: Most intelligent, best for complex reasoning (slower, more expensive)",
            "GPT-4o-mini: Balanced performance and cost (recommended for most uses)",
            "GPT-3.5 Turbo: Fastest and most economical (lower quality reasoning)"
          ],
          "order": 15
        },
        "localrag.agenticIncludeWorkspaceContext": {
          "type": "boolean",
          "default": true,
          "markdownDescription": "**Include workspace context:** Pass selected code, active file, imports, and symbols to Copilot (like #codebase).\n\n**Includes:**\n- Selected code (max 1000 chars)\n- File imports and symbols\n- Workspace name\n\n**Privacy:** Only relative paths, no sensitive data\n\n‚ö†Ô∏è _Only applies when LLM Mode is enabled_",
          "order": 16
        },
        "localrag.recursiveDirectory": {
          "type": "boolean",
          "default": false,
          "markdownDescription": "**Recursively scan directories** when adding folders to topics. When enabled, all subdirectories will be scanned for supported files. When disabled, only files in the selected directory will be included.",
          "order": 17
        },
        "localrag.includeExtensions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [
            ".pdf",
            ".md",
            ".markdown",
            ".html",
            ".htm",
            ".txt"
          ],
          "markdownDescription": "**File extensions to include** when scanning directories for documents. Only files with these extensions will be processed. Leave empty to include all supported extensions.",
          "order": 18
        },
        "localrag.watchFolder": {
          "type": "string",
          "default": "",
          "markdownDescription": "**Folder to watch for changes**: Specify an absolute path to a folder that will be automatically monitored. When files are added, modified, or deleted in this folder, the default topic will be automatically updated. Leave empty to disable folder watching.",
          "order": 19
        },
        "localrag.watchFolderRecursive": {
          "type": "boolean",
          "default": true,
          "markdownDescription": "**Watch folder recursively**: When enabled, subdirectories of the watch folder will also be monitored for changes. Only applies when `watchFolder` is set.",
          "order": 20
        }
      }
    },
    "commands": [
      {
        "command": "localrag.createTopic",
        "title": "Create New Topic",
        "category": "LocalRAG",
        "icon": "$(add)"
      },
      {
        "command": "localrag.deleteTopic",
        "title": "Delete Topic",
        "category": "LocalRAG",
        "icon": "$(trash)"
      },
      {
        "command": "localrag.addDocument",
        "title": "Add Document to Topic",
        "category": "LocalRAG",
        "icon": "$(file-directory-create)"
      },
      {
        "command": "localrag.addGithubRepo",
        "title": "Add Git Repository to Topic",
        "category": "LocalRAG",
        "icon": "$(github)"
      },
      {
        "command": "localrag.refreshTopics",
        "title": "Refresh Topics",
        "category": "LocalRAG",
        "icon": "$(refresh)"
      },
      {
        "command": "localrag.clearModelCache",
        "title": "Clear Model Cache",
        "category": "LocalRAG"
      },
      {
        "command": "localrag.clearDatabase",
        "title": "Clear Database",
        "category": "LocalRAG"
      },
      {
        "command": "localrag.addGithubToken",
        "title": "Add GitHub Token",
        "category": "LocalRAG",
        "icon": "$(key)"
      },
      {
        "command": "localrag.listGithubTokens",
        "title": "List GitHub Tokens",
        "category": "LocalRAG"
      },
      {
        "command": "localrag.removeGithubToken",
        "title": "Remove GitHub Token",
        "category": "LocalRAG",
        "icon": "$(trash)"
      }
    ],
    "viewsContainers": {
      "activitybar": [
        {
          "id": "localrag",
          "title": "LocalRAG Topics",
          "icon": "$(database)"
        }
      ]
    },
    "views": {
      "localrag": [
        {
          "id": "ragTopics",
          "name": "Topics",
          "icon": "$(files)"
        }
      ]
    },
    "viewsWelcome": [
      {
        "view": "ragTopics",
        "contents": "No topics yet. Create your first topic to start using LocalRAG!\n[Create Topic](command:localrag.createTopic)\nTopics help organize your documents for semantic search and retrieval-augmented generation with Copilot."
      }
    ],
    "menus": {
      "view/title": [
        {
          "command": "localrag.createTopic",
          "when": "view == ragTopics",
          "group": "navigation@1"
        },
        {
          "command": "localrag.refreshTopics",
          "when": "view == ragTopics",
          "group": "navigation@2"
        }
      ],
      "view/item/context": [
        {
          "command": "localrag.addDocument",
          "when": "view == ragTopics && viewItem == topic",
          "group": "inline@1"
        },
        {
          "command": "localrag.addGithubRepo",
          "when": "view == ragTopics && viewItem == topic",
          "group": "inline@2"
        },
        {
          "command": "localrag.deleteTopic",
          "when": "view == ragTopics && viewItem == topic",
          "group": "inline@3"
        }
      ]
    },
    "languageModelTools": [
      {
        "name": "ragQuery",
        "tags": [
          "documentation",
          "search",
          "copilot",
          "context",
          "rag"
        ],
        "toolReferenceName": "ragQuery",
        "displayName": "RAG Query",
        "modelDescription": "Use this tool when the user asks questions about topics they have added to the RAG system. Supports both simple single-shot retrieval and advanced agentic RAG with multi-step query planning, iterative refinement, and intelligent result evaluation. The tool intelligently matches the requested topic: it first tries an exact match, then finds the most semantically similar topic if no exact match exists. In agentic mode, complex queries are automatically decomposed into sub-queries for comprehensive information gathering. Always check the 'topicMatched' field and 'agenticMetadata' in the response.",
        "icon": "$(database)",
        "canBeReferencedInPrompt": true,
        "inputSchema": {
          "type": "object",
          "properties": {
            "topic": {
              "type": "string",
              "description": "The name of the topic to search within (e.g., 'React Documentation', 'Company Policy'). If exact match is not found, the most semantically similar topic will be automatically selected."
            },
            "query": {
              "type": "string",
              "description": "The search query or question to find relevant information"
            },
            "topK": {
              "type": "number",
              "description": "Number of top results to return (optional, uses configured value if not provided)"
            },
            "retrievalStrategy": {
              "type": "string",
              "description": "Retrieval strategy: 'vector' (semantic only), 'hybrid' (semantic + keyword), 'ensemble' (RRF fusion), or 'bm25' (keyword only). Optional - uses configured value if not provided.",
              "enum": [
                "vector",
                "hybrid",
                "ensemble",
                "bm25"
              ]
            },
            "useAgenticMode": {
              "type": "boolean",
              "description": "Enable agentic RAG with multi-step query planning and iterative retrieval (optional, defaults to extension settings). Note: All agentic configuration (iterations, confidence, etc.) is controlled via VS Code settings and cannot be overridden per query."
            }
          },
          "required": [
            "topic",
            "query"
          ]
        }
      }
    ]
  },
  "scripts": {
    "vscode:prepublish": "npm run compile",
    "compile": "tsc -p ./",
    "compile:tests": "tsc -p ./tsconfig.test.json",
    "watch": "tsc -watch -p ./",
    "watch:tests": "tsc -watch -p ./tsconfig.test.json",
    "lint": "eslint src",
    "package:dev": "node scripts/package-dev.js",
    "package": "npm run package:win32-x64 && npm run package:win32-arm64 && npm run package:darwin-x64 && npm run package:darwin-arm64 && npm run package:linux-x64 && npm run package:linux-arm64",
    "package:win32-x64": "node scripts/install-platform-deps.js win32-x64 && vsce package --target win32-x64",
    "package:win32-arm64": "node scripts/install-platform-deps.js win32-arm64 && vsce package --target win32-arm64",
    "package:darwin-x64": "node scripts/install-platform-deps.js darwin-x64 && vsce package --target darwin-x64",
    "package:darwin-arm64": "node scripts/install-platform-deps.js darwin-arm64 && vsce package --target darwin-arm64",
    "package:linux-x64": "node scripts/install-platform-deps.js linux-x64 && vsce package --target linux-x64",
    "package:linux-arm64": "node scripts/install-platform-deps.js linux-arm64 && vsce package --target linux-arm64",
    "publish": "npm run publish:win32-x64 && npm run publish:win32-arm64 && npm run publish:darwin-x64 && npm run publish:darwin-arm64 && npm run publish:linux-x64 && npm run publish:linux-arm64",
    "publish:win32-x64": "node scripts/install-platform-deps.js win32-x64 && vsce publish --target win32-x64",
    "publish:win32-arm64": "node scripts/install-platform-deps.js win32-arm64 && vsce publish --target win32-arm64",
    "publish:darwin-x64": "node scripts/install-platform-deps.js darwin-x64 && vsce publish --target darwin-x64",
    "publish:darwin-arm64": "node scripts/install-platform-deps.js darwin-arm64 && vsce publish --target darwin-arm64",
    "publish:linux-x64": "node scripts/install-platform-deps.js linux-x64 && vsce publish --target linux-x64",
    "publish:linux-arm64": "node scripts/install-platform-deps.js linux-arm64 && vsce publish --target linux-arm64",
    "pretest": "npm run compile && npm run compile:tests",
    "test": "node ./out/test/test/runTest.js",
    "inspect:chunks": "npm run compile && node scripts/inspect-chunks.js",
    "clean": "rimraf out && rimraf node_modules",
    "clean:test": "rimraf out/test",
    "t": "npm run compile && npm run package:darwin-arm64 && code --install-extension localrag-darwin-arm64-*.vsix"
  },
  "devDependencies": {
    "@eslint/js": "^9.39.1",
    "@types/chai": "^5.2.3",
    "@types/cheerio": "^0.22.35",
    "@types/glob": "^7.2.0",
    "@types/mocha": "^10.0.10",
    "@types/node": "^22.10.5",
    "@types/pdf-parse": "^1.1.5",
    "@types/vscode": "^1.105.0",
    "@typescript-eslint/eslint-plugin": "^8.46.3",
    "@typescript-eslint/parser": "^8.46.3",
    "@vscode/test-cli": "^0.0.12",
    "@vscode/test-electron": "^2.5.2",
    "@vscode/vsce": "^3.6.2",
    "chai": "^5.1.2",
    "eslint": "^9.39.1",
    "glob": "^10.4.5",
    "mocha": "^11.0.1",
    "rimraf": "^6.0.1",
    "typescript": "^5.9.3",
    "typescript-eslint": "^8.47.0"
  },
  "dependencies": {
    "@huggingface/transformers": "^3.7.6",
    "@lancedb/lancedb": "^0.19.1",
    "@langchain/community": "^1.0.0",
    "@langchain/core": "^1.0.0",
    "@langchain/textsplitters": "^1.0.0",
    "async-mutex": "^0.5.0",
    "cheerio": "^1.1.2",
    "ignore": "^5.3.2",
    "langchain": "^1.0.0",
    "pdf-parse": "^1.1.1",
    "reflect-metadata": "^0.2.2",
    "zod": "^3.22.4"
  },
  "optionalDependencies": {
    "@img/sharp-darwin-arm64": "^0.34.5",
    "@img/sharp-darwin-x64": "^0.34.5",
    "@img/sharp-libvips-darwin-arm64": "^1.2.4",
    "@img/sharp-libvips-darwin-x64": "^1.2.4",
    "@img/sharp-libvips-linux-arm64": "^1.2.4",
    "@img/sharp-libvips-linux-x64": "^1.2.4",
    "@img/sharp-libvips-win32-arm64": "^1.2.4",
    "@img/sharp-libvips-win32-x64": "^1.2.4",
    "@img/sharp-linux-arm64": "^0.34.5",
    "@img/sharp-linux-x64": "^0.34.5",
    "@img/sharp-win32-arm64": "^0.34.5",
    "@img/sharp-win32-x64": "^0.34.5",
    "@lancedb/lancedb-darwin-arm64": "^0.19.1",
    "@lancedb/lancedb-darwin-x64": "^0.19.1",
    "@lancedb/lancedb-linux-arm64-gnu": "^0.19.1",
    "@lancedb/lancedb-linux-x64-gnu": "^0.19.1",
    "@lancedb/lancedb-win32-arm64-msvc": "^0.19.1",
    "@lancedb/lancedb-win32-x64-msvc": "^0.19.1"
  },
  "overrides": {
    "fsevents": {
      "install": ""
    }
  }
}
